---
# Quarto options
title: ggplot2 3.6.0に備えよう
format:
  gfm:
    variant: +yaml_metadata_block

# Slidev options
theme: default
background: /background.png
class: text-center
drawings:
  persist: false
# enable MDC Syntax: https://sli.dev/features/mdc
mdc: true
---

```{r}
#| include: false
knitr::opts_knit$set(
  base.dir = here::here("public/")
)

knitr::opts_chunk$set(
  fig.path = "plot/"
)

orig_hook <- knitr::knit_hooks$get("plot")

knitr::knit_hooks$set(
  plot = function(x, options) {
    x <- orig_hook(x, options)
    gsub("![](plot/", "![](/plot/", x, fixed = TRUE)
  }
)

library(ggplot2)
```

# ggplot2<br/>3.6.0<br/>に備えよう

2025/02/16 SappoRo.R#12

@yutannihilation

```{=html}
---
layout: image-right
image: "/icon.jpg"
---
```

# ドーモ！

## 名前:

湯谷啓明
(@yutannihilation)

## 好きな言語:

R、Rust、忍殺語

## 近況:

MIERUNE 入社

```{=html}
---
layout: default
---
```

# ggplot2 3.6.0

<v-clicks>

- 今年5月頃？
- 100年に1度の出来と言われた2024年を超す21世紀最高の出来栄え（ボジョレーヌーボー風）
- つまり、けっこう変更がある

</v-clicks>


```{=html}
---
layout: default
---
```

# けっこう変更がある

- <https://ggplot2.tidyverse.org/dev/news/index.html>

```{=html}
---
layout: default
---
```

# Theme の強化

- `theme(geom = )`
- `ink` と `paper`
- `from_theme()`
- `theme(palette = )`
- `geom_marquee()`, `element_marquee()`

```{=html}
---
layout: default
---
```

# これまで

- だいたいのスタイルは `theme()` で設定できる
- と言いつつ「ただし、」が多かった

```{=html}
---
layout: default
---
```

# 「ただし」の例

- `colour` や `fill` の scale は `options()`
  ```r
  options(
    ggplot2.continuous.colour = "viridis",
    ggplot2.continuous.fill = "viridis"
  )
  ```
- `Geom` の点や線の大きさ、色などは `update_geom_defaults()`
  ```r
  update_geom_defaults("point", aes(color = "red"))
  ```

```{=html}
---
layout: default
---
```

# 「ただし」の例

- `theme(text = )` の指定は `geom_text()` などには引き継がれない（けっこうハマりがち）
- `theme(text = )` のサイズは `geom_text()` のサイズ指定と単位が違う


```{=html}
---
layout: default
---
```

# `theme(geom = )`

* `element_geom()` でデフォルトのスタイルを指定できるようになった

```{r}
#| label: element_geom
#| output: false
p <- ggplot(mpg, aes(displ, hwy)) + geom_point()

p2 <- p +
  theme(
    geom = element_geom(
      pointshape = "square",
      pointsize = 8
    )
  )
```

```{=html}
---
layout: default
---
```

```{r}
#| echo: false
patchwork::wrap_plots(
  p + ggtitle("original"),
  p2 + ggtitle("+ theme(...)")
)
```

```{=html}
---
layout: default
---
```

# `ink` と `paper`

